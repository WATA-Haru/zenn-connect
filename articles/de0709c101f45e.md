---
title: Zenn CLI + Obsidianで技術記事の執筆環境を作る
emoji: 🐷
type: tech
topics:
  - obsidian
  - zenn
published: false
publication_name: bita
---
## はじめに
Zenn CLI + Obsidianで記事を書く一連の流れを紹介します。
Zennの記事を書く際の参考になれば幸いです。
### 書くこと
- Zenn CLI + Obsidianで記事を書いていて便利な点
- 記事を書く手順
### 書かないこと
- Githubの使い方
- Zenn CLIの設定方法とインストール方法
- Obsidianのインストール方法
## Zenn CLI + Obsidianが便利な点
### Zenn CLI
- `npx zenn new:article`で記事のテンプレートを生成できます。
- `npx zenn preview`を使うとローカルで記事がプレビューできます。変更した場合もリロードせずにプレビューに反映されます。
- Githubで管理できるので、書きたいネタがあったときにGithubのIssueにアイデアを残して管理できます。
### Obsidian
- **画像を移動させたときに画像パスが自動で変更されます。**(※Zenn CLIのパスのルールに適応させるために一部置換が必要)
- Obsidianはマークダウンエディタなので、`npx zenn preview`しなくとも記事になった際の見た目がだいたい分かります。
## (参考) 実際に記事を管理しているリポジトリ
こちらのリポジトリで管理しています。commitIDは記事執筆時点のものです。
https://github.com/WATA-Haru/zenn-connect/tree/885e732e09b1be97cbdb75f5ef26c04c11ff1442
## 記事を書く流れ
記事を書く流れを詳しく書いたら想像以上に項目が増えてしまったので、重要な部分には★マークを付けました。
### 1. 事前準備
本記事では詳しく解説しませんが、以下が必要になります
- `git clone`できるターミナル
- 記事を管理するためのGithubリポジトリ + Zennとの紐づけ
- Zenn CLIのインストール
- Obsidianのインストール

Obsidianはこちらからダウンロードしてください
https://obsidian.md/

Zenn CLIの説明とGithubリポジトリとの紐づけ方法はZennの公式記事があるのでそちらをご参照ください。
https://zenn.dev/zenn/articles/install-zenn-cli
https://zenn.dev/zenn/articles/zenn-cli-guide
https://zenn.dev/zenn/articles/connect-to-github
#### Zennと紐づいたGithubリポジトリをcloneする
事前準備で済んでいるかとは思いますが簡単に流れを書きます。
1. Zennと紐づいたGithubのリポジトリを作成
2. ローカルにZennと紐づいたGithubのリポジトリを`git clone`
3. `npm install`など、パッケージマネージャを使って`zenn-cli`をインストール

以下のようなディレクトリ構成になっているかと思います
```
├─articles       # 記事の保存先
├─books          # 本の保存先  
├─images         # 画像の保存先
└─node_modules   # zenn-cliがインストールされたnode_modules
    └─zenn-cli
    ...# その他のパッケージ
```

### 2. Githubでissueからブランチを作成
#### 記事作成用の`issue`を立てる
Githubのissueを立てます。この画像の`Labels`には、自分で作った`article`ラベルをつけています。
issueを作ったら、issueの`Add a title`に記事のタイトルを付けます。正式なタイトルである必要はなく、自分で分かれば良いです。
![Add a titleの入力欄にtitleを入れる](/images/de0709c101f45e/Pasted%20image%2020251219181551.png)

#### `issue`からブランチを作成する
`Create a branch`をクリックしてissueに紐づくブランチを作成します。
![Development > Create a branchをクリックブランチを作成する](/images/de0709c101f45e/Pasted%20image%2020251219195830.png)
`Create a branch for this issue`のポップアップが出ます。
![issueのタイトルと同じ名前のbranch名が書いたポップアップ](/images/de0709c101f45e/Pasted%20image%2020251219195931.png)
デフォルトではissueのタイトルが`Branch name`になるので、好きな名前に変更します。
![Branch nameを任意の値に変更](/images/de0709c101f45e/Pasted%20image%2020251219200018.png)
`Checkout locally`を選択して、`Create branch`を押すと、以下のように `Checkout in your local repository`のポップアップがでてきます。
リモートに作ったブランチをローカルにチェックアウトするためのコマンドが表示されるので、コピーのアイコンからコピーします。
![リモートに作ったブランチをローカルにチェックアウトするためのコマンドが表示される](/images/de0709c101f45e/Pasted%20image%2020251219200529.png)

以下のようなコマンドがコピーされると思うので、ブランチをリモートから取得してローカルでチェックアウトします。
```shell
git fetch origin
git checkout <your-issue-branch-name>
```

### 3. Obsidianの設定

#### vaultでリポジトリを開く
Obsidianを立ち上げ、`Open folder as vault`をクリックします。
![Obsidianの初期画面、Open folder as vaultのOpenをクリック](/images/de0709c101f45e/Pasted%20image%2020251219205008.png)

ファイルエクスプローラーから、記事管理用のリポジトリを選択します。
(以下はWindows11の例)
![Obsidianのディレクトリを選択](/images/de0709c101f45e/Pasted%20image%2020251219205155.png)

以下の画像のように、記事管理用のリポジトリがvaultとして開けたら大丈夫です。
![Zennに紐づいたリポジトリをObsidianで開く画面](/images/de0709c101f45e/Pasted%20image%2020251219205429.png)


#### Obsidianのパス設定を変更
##### Wikilinkを解除
Obsidianには`[[]]`でvalut内のファイルリンクが張れるWikilinkというものがあります。
これは通常のMarkdown記法にはないので、無効化して通常のリンク形式にします。
![use wikilink を無効化](/images/de0709c101f45e/Pasted%20image%2020251219221301.png)
##### Obsidianの画像パスをvault内の絶対パスにする★
ここが重要です。Obsidianの画像パス設定を変更します。

設定から、`Files and links`を選択します。
そして、`Links > New link format`を`Absolute path in vault`(保管庫内での絶対パス)に変更してください。
![Absolute path in vault 保管庫内での絶対パスに画像パス形式を変更](/images/de0709c101f45e/Pasted%20image%2020251219212056.png)
これで、画像パスがObsidianの`Vault`内部での絶対パスになります。
Zenn CLIで扱う画像パスは`/images/`から始まる絶対パスににする必要があるので、上記の設定が必ず必要になります。

これで完了だとよいのですが、Obsidianだと`/images/`ではなく`images/`でファイルのパスが作成されるので、Zenn CLIに合わせて`images/`を`/images/`に置換する作業が必要になります。記事が作成完了したタイミングで一括置換します。(後述)

### 4. Zenn CLI で記事を新規作成する
ターミナルに入ります。記事を管理しているリポジトリのルートディレクトリに移動して、以下のコマンドを入力します。
```shell
npx zenn new:article
```

私は`npx zenn new: article`と打つのが面倒なので、`package.json`の`scripts`にカスタムコマンドを作っています。
```package.json
{
  "name": "zenn-connect",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "new": "npx zenn new:article",
    "preview": "npx zenn preview"
  },
  // 以下省略
}
```
このように設定すると、記事の新規作成は`npm run new`、記事のプレビューは`npm run preview`でできて便利です。

それでは、記事を新規作成します。
```shell
$> npx zenn new:article
created: articles/21f513e2020beb.md
```

Obsidianでは以下のように表示されます。
![Zenn CLIで新規作成した記事をObsidianで表示する](/images/de0709c101f45e/Pasted%20image%2020251219210849.png)

#### `images`配下に画像用ディレクトリを作成
`images`配下に画像用ディレクトリを作成します。
特にルールはありませんが、私は`<記事のnanoid>/<name>.png`のような形式で保存しています。

先ほど作成した`21f513e2020beb.md`にならって、`images`配下に`21f513e2020beb`ディレクトリを作成します。
![画像のパス名のディレクトリをimages配下に作成](/images/de0709c101f45e/Pasted%20image%2020251219211206.png)

### 5. 執筆~公開まで
#### 記事の執筆とおすすめプラグインの紹介
後は作った記事に内容を書きます。
簡単な紹介にはなりますが、[Terminal](https://github.com/polyipseity/obsidian-terminal)プラグインを使うと、Zenn CLIでの記事作成とプレビューがObsidianの中だけでできて大変便利です。

![Obsidian TerminalでObsidianの中からZenn CLIを使う](/images/de0709c101f45e/Pasted%20image%2020251219211551.png)
#### 画像パスの一括置換★
Obsidianだと画像のパスが`/images/`ではなく`images/`で始まります。Zenn CLIでは`/images/`のように`/`で始まるパスでないと読み込めないのでリネームします。

1. Ctrl + Hを押して、現在のノート内検索と置換をします。
![Ctrl + Hで現在のノート内検索と置換を出す](/images/de0709c101f45e/Pasted%20image%2020251219214021.png)

2. `](images/`を上の検索欄に入力し、下の入力欄に`](/images/`を入力します。
   その後、Replace all(画像内赤枠)をクリックして一括置換します。

![`](images/`を上の検索欄に、`](/images/`を下の検索欄に入力してReplace allをクリック](/images/de0709c101f45e/Pasted%20image%2020251219214159.png)

これで`images/`で始まっていた画像パスが`/images/`から始まるように置き換わりました。
![images/が/imagesに置き換わった画像](/images/de0709c101f45e/Pasted%20image%2020251219214321.png)
#### Zenn CLIで記事のプレビューを見る
記事が書けたら記事のプレビューを確認します。
以下のコマンドを入力するとブラウザのlocalhostで記事のプレビューが表示されます。
```shell
npx zenn preview
```

![記事のプレビュー](/images/de0709c101f45e/Pasted%20image%2020251219231310.png)
#### ローカルの変更をリモートリポジトリに反映する
プレビューを見て問題がなさそうならリモートリポジトリに`git push`して変更を反映します。
#### `Pull Request`を送り、`main`にマージする
Pull Requestを作成します。`Create pull request`をクリックします。
![Pull Request作成画面](/images/de0709c101f45e/Pasted%20image%2020251219220207.png)

問題がなければ`Merge pull request`をクリックします。
![Merge pull request画面](/images/de0709c101f45e/Pasted%20image%2020251219220334.png)

#### Zennに自分の記事が反映される
mainにマージされるとZennが勝手にデプロイしてくれて、自分の記事が上がります。
これで以上になります。
## おわりに
余談ですが、頑張りすぎないように記事を管理しています。
自分しか使わないので`main`に直にプッシュしますし、ブランチ名やコミット粒度もテキトーです。画像のパス名も規則なく決めています。ガチガチに作りすぎると記事を書きたくなくなってしまうのでまじめにやりすぎないようにしています。

本記事がZennの記事を書く上で少しでも役に立てば幸いです。
