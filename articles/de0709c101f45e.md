---
title: Zenn CLI + Obsidianで技術記事の執筆環境を作る
emoji: 🐷
type: tech
topics:
  - obsidian
  - zenn
published: false
publication_name: bita
---
## はじめに
私はZennで記事を書く際にZenn CLIとObsidianを使っています。
以前はZenn CLIとVisual Studio Codeで記事を書いていましたが、上記の組み合わせが便利だったので、Zenn CLI + Obisidianで記事を書く一連の流れを紹介します。
Zennの記事を書く際の一助になれば幸いです。
## 書くこと
- Zenn CLI + Obsidianで記事を書く手順
## 書かないこと
- Githubの使い方
- Zenn CLIのインストール方法と使い方
- Obsidianのインストール方法
## Zenn CLI + Obsidianが便利な点
初めに、Zenn CLIとObsidianを使っていて便利だった点について列挙します。
### Zenn CLI
- `npx zenn new:article`で重複しない[nanoid](https://github.com/ai/nanoid)のパスで記事を作成できます。重複しないパス名を考える必要がありません。
- `npx zenn preview`を使うとローカルで記事がプレビューできます。変更した場合もリロードせずにプレビューに反映されます。
- Zenn CLIはGithubのリポジトリと紐づけができます。Zennと紐づけられたリポジトリの`main`ブランチに変更がmergeされたときに記事の内容を自動でデプロイしてくれます。
- Githubで管理できるので、書きたいネタがあったときにGithubのIssueにアイデアを残して管理できます。
### Obsidian
- **画像を移動させたときに画像パスが自動で変更されます。**(※Zenn CLIのパスルールに適応させるために一部一括置換が必要)
- Obsidianはマークダウンエディタなので、`npx zenn preview`しなくとも記事になった際の見た目がだいたい分かります。
## 記事を書く流れ
### 事前準備
以下が必要です。これらはすでにあるものとして手順を紹介します。
- 記事を管理するためのGithubリポジトリ + `git clone`できるターミナル
- Obsidian
- Zenn CLI

Obsidianはこちらからダウンロードしてください
https://obsidian.md/

Zenn CLIの説明とGithubリポジトリとの紐づけ方法はZennの公式記事があるのでそちらをご参照ください。
https://zenn.dev/zenn/articles/install-zenn-cli
https://zenn.dev/zenn/articles/zenn-cli-guide
https://zenn.dev/zenn/articles/connect-to-github
### 実際に記事を管理しているリポジトリ
こちらのリポジトリで管理しています。commitIDは記事執筆時点のものです。
https://github.com/WATA-Haru/zenn-connect/tree/885e732e09b1be97cbdb75f5ef26c04c11ff1442
### 1. Zennと紐づいたGithubリポジトリをcloneする
事前準備で済んでいるかとは思いますが簡単に流れを書きます。
1. Zennと紐づいたGithubのリポジトリを作成
2. ローカルにZennと紐づいたGithubのリポジトリを`git clone`
3. `npm install`など、パッケージマネージャを使って`zenn-cli`をインストール

以下のようなディレクトリ構成になっているかと思います
```
├─articles       # 記事の保存先
├─books          # 本の保存先  
├─esimages         # 画像の保存先
└─node_modules   # zenn-cliがインストールされたnode_modules
    └─zenn-cli
    ...# その他のパッケージ
```

### 2. 記事に紐づいた`issue`を立てる
Githubのissueを立てます。この画像の`Labels`には、自分で作った`article`ラベルをつけています。

issueを作ったら、issueの`Add a title`に記事のタイトルを付けます。正式なタイトルである必要はなく、自分で分かれば良いです。
![Add a titleの入力欄にtitleを入れる](/images/de0709c101f45e/Pasted%20image%2020251219181551.png)

### 3. `issue`からブランチを作成する
`Create a branch`をクリックします。
TODO: create a branchの赤枠
![Development > Create a branchをクリックブランチを作成する](/images/de0709c101f45e/Pasted%20image%2020251219195830.png)
`Create a branch for this issue`のポップアップが出ます。
![issueのタイトルと同じ名前のbranch名が書いたポップアップ](/images/de0709c101f45e/Pasted%20image%2020251219195931.png)

デフォルトでは`Branch name`がissueのタイトルなので、好きな名前に変更します。
![Branch nameを任意の値に変更](/images/de0709c101f45e/Pasted%20image%2020251219200018.png)

`Checkout locally`を選択して、`Create branch`を押すと、以下のように `Checkout in your local repository`のポップアップが表示され、リモートに作ったブランチをローカルにチェックリストするためのコートが表示されます。コピーのUIがあるのでそこをクリックしてコピーします。
![リモートに作ったブランチをローカルにチェックリストするためのコートが表示される](/images/de0709c101f45e/Pasted%20image%2020251219200529.png)

以下のようなコードがコピーされると思うので、ブランチをリモートから取得してローカルでチェックアウトします。
```shell
git fetch origin
git checkout <your-issue-branch-name>
```

### 4. Obsidianのvalutでリポジトリを開く
Obsidianの画面で`Open folder as vault`をクリックします。
![Obsidianの初期画面、Open folder as vaultのOpenをクリック](/images/de0709c101f45e/Pasted%20image%2020251219205008.png)

私はWindowsを使っているので以下のようなUIになります。Zennと紐づいたローカルのリポジトリを選択します。
![Obsidianのディレクトリを選択](/images/de0709c101f45e/Pasted%20image%2020251219205155.png)

以下の画像のようにZennに紐づいたリポジトリがvaultとして開けたら大丈夫です。
![Zennに紐づいたリポジトリをObsidianで開く画面](/images/de0709c101f45e/Pasted%20image%2020251219205429.png)

### 5. Zenn CLI で記事を新規作成する
ターミナルで記事を管理しているリポジトリのルートディレクトリに移動します。
```shell
npx zenn new:article
```
を入力して記事を作成します。

私は`npx zenn new: article`と打つのが面倒なので、`package.json`の`scripts`にカスタムコマンドを作っています。
```package.json
{
  "name": "zenn-connect",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "new": "npx zenn new:article",
    "preview": "npx zenn preview"
  },
  // 以下省略
}
```
このように設定すると、記事の新規作成は`npm run new`、記事のプレビューは`npm run preview`でできて便利です。

それでは、記事を新規作成します。
```shell
$> npx zenn new:article
created: articles/21f513e2020beb.md
```

Obsidianでは以下のように表示されると思います。
![Zenn CLIで新規作成した記事をObsidianで表示する](/images/de0709c101f45e/Pasted%20image%2020251219210849.png)

### Obsidianのパス設定を変更
ここが最も重要です。
### Wikilinkを解除
Obsidianには`[[]]`でリンクが張れるWikilinkというものがあります。便利ですが、Markdown記法にWikilinkはないので、無効化して通常のリンク形式にします。
![use wikilink を無効化](/images/de0709c101f45e/Pasted%20image%2020251219212056.png)

### Obsidianの画像パスをvault内の絶対パスにする
Obsidianの画像パス設定を変更します。

設定から、`Files and links`を選択します。
そして、`Links > New link format`を`Absolute path in vault`(保管庫内での絶対パス)に変更してください。
![Absolute path in vault 保管庫内での絶対パスに画像パス形式を変更](/images/de0709c101f45e/Pasted%20image%2020251219212056.png)

これで、画像パスがObsidianの`Vault`内部での絶対パスになります。
Zenn CLIで扱う画像パスは`/images/`から始まる絶対パスににする必要があるので、上記の設定が必ず必要になります。
これで完了だとよいのですが、Obsidianだと`/images/`ではなく`images/`でファイルのパスが作成されるので、後で`images/`を`/images/`にリネームする作業が必要になります。(後述)

### `images`配下に画像用ディレクトリを作成
`images`配下に画像用ディレクトリを作成します。
特にルールはありませんが、私は`<記事のnanoid>/<name>.png`のような形式で保存しています。

先ほど作成した`21f513e2020beb.md`にならって、`images`配下に`21f513e2020beb`ディレクトリを作成します。
![画像のパス名のディレクトリをimages配下に作成](/images/de0709c101f45e/Pasted%20image%2020251219211206.png)

### 記事の執筆
後は作った記事に内容を書きます。
プラグインの紹介にはなりますが、[Terminal](https://github.com/polyipseity/obsidian-terminal)プラグインを使うと、Zenn CLIでの記事作成とプレビューがObsidianの中だけでできて大変便利です。

![Obsidian TerminalでObsidianの中からZenn CLIを使う](/images/de0709c101f45e/Pasted%20image%2020251219211551.png)
### 6. 画像パスの一括rename
Obsidianだと画像のパスが`/images/`ではなく`images/`で作成されます。Zenn CLIでは`/images/`でないと読み込めないのでリネームします。

Ctrl + Hを押して、現在のノート内検索と置換をします。
![Ctrl + Hで現在のノート内検索と置換を出す](/images/de0709c101f45e/Pasted%20image%2020251219214021.png)

`](images/`を上の検索欄に入力します。次に、下の入力欄に`](/images/`を入力ます。
終わったら、Replace allをクリックして一括置換します。

![`](images/`を上の検索欄に、`](/images/`を下の検索欄に入力してReplace allをクリック](images/de0709c101f45e/Pasted%20image%2020251219214159.png)

`images/`で始まっていた画像パスが`/images/`から始まるように置き換わったことが分かります。
![images/が/imagesに置き換わった画像](/images/de0709c101f45e/Pasted%20image%2020251219214321.png)
### 7. Zenn CLIで記事のプレビューを見る

```shell
npx zenn preview
```
で記事のプレビューを見ます。
### 8. ローカルの変更をリモートリポジトリに反映する
プレビューを見て問題がなさそうならリモートリポジトリに変更を反映します。
### 8. `Pull Request`を送り、`main`にマージする

### 9. Zennに自分の記事が反映される
mainにマージされるとZennに記事が上がります。
これで以上です。
## 終わりに
余談ですが、あまり真面目に記事を管理しないようにしています。
自分しか使わないので`main`に直にpushもよくしますし、`branch`名もテキトーです。そして、画像のパス名も規則なく決めています。ガチガチに作りすぎると記事を書きたくなくなってしまうのでまじめにやりすぎないようにしています。

よりよい記事の管理方法は他にもあると思いますが、少しでも役に立てば幸いです。