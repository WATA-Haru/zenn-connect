---
title: Vimのコマンドラインウィンドウでコマンド履歴を編集・コピーする
emoji: 🐧
type: tech # tech: 技術記事 / idea: アイデア
topics:
  - vim
published: true
publication_name: bita
---
🎄この記事は bitA Tech Blog Advent Calendar の16日目の記事です。

## はじめに

Vimのコマンドラインモードを使う際、自分が過去に使ったコマンドの履歴をコピーしたい場合や長く複雑なコマンドを入力したい場合があります。

このような場合に、Vimのコマンドラインウィンドウを使うと便利だったのでコマンドラインウィンドウの開き方と実際の画面を紹介します。

以下では、Ctrlを含む入力を`<C-*>`のように表記します。(`*`は任意のキー)

## Vimのコマンドラインウィンドウとは

Vimにはコマンドラインウィンドウという機能があります。
@[card](https://vim-jp.org/vimdoc-ja/cmdline.html#cmdline-window)

コマンドラインウィンドウを開くと、以下の画像のようにコマンドの履歴が表示され、ビジュアルモードやインサートモードでの操作、編集ができます。

![コマンドラインウィンドウでコマンドの履歴一覧が表示される様子](/images/c69d9bf1d9822e/Pasted%20image%2020251216204455.png)

## コマンドラインウィンドウの開き方

※スクリーンショットを撮ったため、添付画像に`<Snapshot>`のキー入力が含まれていますが無視してください。

### ノーマルモードから開く場合: `q:`

ノーマルモードからコマンドラインウィンドウは`q:`で開けます。閉じる時は`:q`で閉じられます。

![`q:`を押下してコマンドラインウィンドウを開く](/images/c69d9bf1d9822e/Pasted%20image%2020251216203924.png)

### コマンドラインモードから開く場合: `<C-f>`

コマンドラインモードからコマンドラインウィンドウは`<C-f>`で開けます。

1. `:`でコマンドラインモードを開く
![`:`でコマンドラインモードを開く](/images/c69d9bf1d9822e/Pasted%20image%2020251216204238.png)

2. `<C-f>`でコマンドラインウィンドウを開く
![`<C-f>`でコマンドラインウィンドウを開く](/images/c69d9bf1d9822e/Pasted%20image%2020251216204200.png)

## コマンドラインウィンドウでの操作例

### ビジュアルモード

コマンドラインウィンドウを開いた後、ビジュアルモード(`v`)で選択後、以下の画像のようにコマンド履歴をヤンクできます。
![コマンドラインウィンドウでビジュアルモードを使って選択する](/images/c69d9bf1d9822e/Pasted%20image%2020251216205000.png)

### インサートモード

コマンドラインウィンドウでインサートモード(`i`)にしてコマンドを入力後、Enterを押すと入力したコマンドが実行されます。

以下に`%s/my-gitconfig/ThisIsSampleText/g`を入力して、画像の8行目にある`7.my-gitconfig`を`7.ThisIsSampleText`に置換する例を示します。

1. コマンドラインウィンドウを開き、`%s/my-gitconfig/ThisIsSampleText/g`を入力する

![`%s/my-gitconfig/ThisIsSampleText/g`をコマンドラインウィンドウで入力する](/images/c69d9bf1d9822e/Pasted%20image%2020251216205232.png)

1. コマンドラインウィンドウのインサートモードのままEnterを押す

![my-gitconfigがThisIsSampleTextに置換された](/images/c69d9bf1d9822e/Pasted%20image%2020251216205511.png)

画像の8行目の`7.my-gitconfig`が`7.ThisIsSampleText`に置換されたことが分かります。

## 参考

@[card](https://vim-jp.org/vimdoc-ja/cmdline.html#cmdline-window)

@[card](https://qiita.com/monaqa/items/e22e6f72308652fc81e2)

@[card](https://qiita.com/gorilla0513/items/f4a5fd835201cf49fda1)
